<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wir wollen reden – Druckkampagne für Maja</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Simple transition for page visibility */
        .page {
            display: none;
            animation: fadeIn 0.5s;
        }
        .page.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .flag-button {
            font-size: 1.5rem; /* Larger emoji size */
            padding: 0.25rem 0.5rem;
            transition: transform 0.2s;
        }
        .flag-button:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 antialiased">

    <div class="container mx-auto p-4 md:p-8 max-w-4xl">

        <section id="home-page" class="page active">
            <header class="text-center mb-8">
                <h1 class="text-4xl md:text-5xl font-bold text-white mb-2" data-translate-key="home_title">Wir wollen reden – Druckkampagne für Maja</h1>
                <p class="text-lg text-blue-300 font-semibold" data-translate-key="home_subtitle">jetzt helfen.</p>
            </header>

            <div class="text-center mb-8">
                <button onclick="showPage('state-selection-page')" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg text-xl transition-transform transform hover:scale-105" data-translate-key="home_main_button">
                    Kontaktiere die Verantwortlichen →
                </button>
            </div>

            <article class="bg-gray-800 p-6 rounded-lg text-gray-300 space-y-4 leading-relaxed">
                <p><strong class="text-white" data-translate-key="home_p1_strong">Seit dem 5. Juni 2025 ist Maja im Hungerstreik.</strong>  Es hat sich seit Beginn des Hungerstreiks bei Linken, Grünen und auch SPD durchaus etwas bewegt. Die Verantwortungsträger*innen in der Regierung und das Auswärtige Amt weisen jedoch immer noch die Verantwortung für die Rücküberstellung von Maja von sich.</p>
                <p class="text-white font-semibold" data-translate-key="home_p2">Wir haben keine Zeit mehr. Wir müssen den Druck auf die Regierung und die Parteien JETZT erhöhen. Deswegen rufen wir dazu auf, das Gespräch mit den Verantwortlichen zu suchen und sie in die Verantwortung zu nehmen.</p>
                <ul class="list-disc list-inside space-y-3 pl-2">
                    <li data-translate-key="home_li1">📢 Sucht gemeinsam die Büros der Regierungsparteien SPD und CDU in euren Städten auf und redet mit den Vertreter*innen der Parteien. Berichtet anschließend davon.</li>
                    <li>
                        <a href="#" onclick="event.preventDefault(); showPage('state-selection-page');" class="text-blue-400 hover:text-blue-300 underline" data-translate-key="home_li2">📞 Kontaktiert die Bundestagsabgeordneten aus eurer Stadt – per Telefon und per E-Mail.</a>
                    </li>
                    <li data-translate-key="home_li3">📧 Kontaktiert das Auswärtige Amt – per Telefon und per E-Mail.</li>
                    <li data-translate-key="home_li4">✊ Parallel dazu ist es wichtig, weiterhin durch Veranstaltungen, Kundgebungen, Demonstrationen und Aktionen des zivilen Ungehorsams Aufmerksamkeit für Majas Hungerstreik zu schaffen.</li>
                </ul>
                <p class="text-right text-sm text-gray-400 pt-4">30. Juni 2025</p>
            </article>

            <div class="text-center mt-8">
                <button onclick="showPage('state-selection-page')" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg text-xl transition-transform transform hover:scale-105" data-translate-key="home_main_button_bottom">
                    Kontaktiere die Verantwortlichen →
                </button>
            </div>
        </section>

        <section id="state-selection-page" class="page">
            <header class="text-center mb-8">
                <button onclick="showPage('home-page')" class="text-blue-400 hover:text-blue-300 mb-4" data-translate-key="back_button">&larr; Zurück zur Startseite</button>
                <h2 class="text-3xl md:text-4xl font-bold text-white" data-translate-key="state_title">Wen willst du kontaktieren?</h2>
                <p class="text-gray-400 mt-2" data-translate-key="state_subtitle">Wähle ein Bundesland, um Aktionen für 10 zufällige Abgeordnete vorzubereiten.</p>
            </header>
            <div id="state-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
                </div>
            <p class="text-center text-lg text-rose-300 mt-10" data-translate-key="thank_you_message">Danke für deinen Einsatz! ❤️</p>
        </section>

        <section id="action-page" class="page">
            <header class="text-center mb-8">
                 <button onclick="showPage('state-selection-page')" class="text-blue-400 hover:text-blue-300 mb-4" data-translate-key="back_button_states">&larr; Anderes Bundesland wählen</button>
                <h2 id="action-page-title" class="text-3xl md:text-4xl font-bold text-white"></h2>
            </header>
            
            <div id="action-content" class="space-y-6">
                </div>
            <p class="text-center text-lg text-rose-300 mt-10" data-translate-key="thank_you_message">Danke für deinen Einsatz! ❤️</p>
        </section>

        <footer class="text-center mt-12 pt-6 border-t border-gray-700">
            <p class="text-gray-400 mb-3" data-translate-key="language_switcher_title">Sprache ändern:</p>
            <div class="flex justify-center space-x-2">
                <button onclick="changeLanguage('de')" title="Deutsch" class="flag-button bg-gray-700 hover:bg-gray-600 rounded-md">🇩🇪</button>
                <button onclick="changeLanguage('tr')" title="Türkçe" class="flag-button bg-gray-700 hover:bg-gray-600 rounded-md">🇹🇷</button>
                <button onclick="changeLanguage('es')" title="Español" class="flag-button bg-gray-700 hover:bg-gray-600 rounded-md">🇪🇸</button>
                <button onclick="changeLanguage('it')" title="Italiano" class="flag-button bg-gray-700 hover:bg-gray-600 rounded-md">🇮🇹</button>
                <button onclick="changeLanguage('fr')" title="Français" class="flag-button bg-gray-700 hover:bg-gray-600 rounded-md">🇫🇷</button>
            </div>
        </footer>

    </div>

    <script>
        // Holen der jsPDF-Funktion
        const { jsPDF } = window.jspdf;

        // ===== DATENBANK =====
        const mdbData = [
            { "anrede": "Herr", "titel": "", "vorname": "Stephan", "nachname": "Albani", "partei": "CDU", "bundesland": "Niedersachsen", "email": "stephan.albani@bundestag.de", "telefon": "030-22777094", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "", "vorname": "Norbert", "nachname": "Altenkamp", "partei": "CDU", "bundesland": "Hessen", "email": "norbert.altenkamp@bundestag.de", "telefon": "030-22779345", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "", "vorname": "Peter", "nachname": "Aumer", "partei": "CSU", "bundesland": "Bayern", "email": "peter.aumer@bundestag.de", "telefon": "030-22773584", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Frau", "titel": "", "vorname": "Silvia", "nachname": "Breher", "partei": "CDU", "bundesland": "Niedersachsen", "email": "silvia.breher@bundestag.de", "telefon": "030-22775550", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "", "vorname": "Ralph", "nachname": "Brinkhaus", "partei": "CDU", "bundesland": "Nordrhein-Westfalen", "email": "ralph.brinkhaus@bundestag.de", "telefon": "030-22775111", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "Dr.", "vorname": "Michael", "nachname": "Frieser", "partei": "CSU", "bundesland": "Bayern", "email": "michael.frieser@bundestag.de", "telefon": "030-22775214", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "", "vorname": "Hermann", "nachname": "Gröhe", "partei": "CDU", "bundesland": "Nordrhein-Westfalen", "email": "hermann.groehe@bundestag.de", "telefon": "030-22773395", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Frau", "titel": "", "vorname": "Monika", "nachname": "Grütters", "partei": "CDU", "bundesland": "Berlin", "email": "monika.gruetters@bundestag.de", "telefon": "030-22772274", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "", "vorname": "Friedrich", "nachname": "Merz", "partei": "CDU", "bundesland": "Nordrhein-Westfalen", "email": "friedrich.merz@bundestag.de", "telefon": "030-22775111", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "Dr.", "vorname": "Johann", "nachname": "Wadephul", "partei": "CDU", "bundesland": "Schleswig-Holstein", "email": "johann.wadephul@bundestag.de", "telefon": "030-22775295", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "", "vorname": "Marco", "nachname": "Wanderwitz", "partei": "CDU", "bundesland": "Sachsen", "email": "marco.wanderwitz@bundestag.de", "telefon": "030-22773648", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Frau", "titel": "", "vorname": "Anja", "nachname": "Weisgerber", "partei": "CSU", "bundesland": "Bayern", "email": "anja.weisgerber@bundestag.de", "telefon": "030-22773041", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "", "vorname": "Kai", "nachname": "Whittaker", "partei": "CDU", "bundesland": "Baden-Württemberg", "email": "kai.whittaker@bundestag.de", "telefon": "030-22773123", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Frau", "titel": "", "vorname": "Katja", "nachname": "Leikert", "partei": "CDU", "bundesland": "Hessen", "email": "katja.leikert@bundestag.de", "telefon": "030-22773669", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "", "vorname": "Philipp", "nachname": "Amthor", "partei": "CDU", "bundesland": "Mecklenburg-Vorpommern", "email": "philipp.amthor@bundestag.de", "telefon": "030-22779261", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "", "vorname": "Thomas", "nachname": "Rachel", "partei": "CDU", "bundesland": "Nordrhein-Westfalen", "email": "thomas.rachel@bundestag.de", "telefon": "030-22775530", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "", "vorname": "Stefan", "nachname": "Ruppert", "partei": "CDU", "bundesland": "Hessen", "email": "stefan.ruppert@bundestag.de", "telefon": "030-22775333", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "", "vorname": "Johannes", "nachname": "Selle", "partei": "CDU", "bundesland": "Thüringen", "email": "johannes.selle@bundestag.de", "telefon": "030-22773380", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "", "vorname": "Jens", "nachname": "Spahn", "partei": "CDU", "bundesland": "Nordrhein-Westfalen", "email": "jens.spahn@bundestag.de", "telefon": "030-22775163", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "Dr.", "vorname": "Andreas", "nachname": "Nick", "partei": "CDU", "bundesland": "Rheinland-Pfalz", "email": "andreas.nick@bundestag.de", "telefon": "030-22773371", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "", "vorname": "Christian", "nachname": "von Stetten", "partei": "CDU", "bundesland": "Baden-Württemberg", "email": "christian.vonstetten@bundestag.de", "telefon": "030-22775185", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "", "vorname": "Volker", "nachname": "Ullrich", "partei": "CSU", "bundesland": "Bayern", "email": "volker.ullrich@bundestag.de", "telefon": "030-22779218", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "", "vorname": "Arnold", "nachname": "Vaatz", "partei": "CDU", "bundesland": "Sachsen", "email": "arnold.vaatz@bundestag.de", "telefon": "030-22775199", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Frau", "titel": "", "vorname": "Nina", "nachname": "Warken", "partei": "CDU", "bundesland": "Baden-Württemberg", "email": "nina.warken@bundestag.de", "telefon": "030-22779311", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "", "vorname": "Klaus-Peter", "nachname": "Willsch", "partei": "CDU", "bundesland": "Hessen", "email": "klaus-peter.willsch@bundestag.de", "telefon": "030-22775365", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "", "vorname": "Nicolas", "nachname": "Zippelius", "partei": "CDU", "bundesland": "Baden-Württemberg", "email": "nicolas.zippelius@bundestag.de", "telefon": "030-22770027", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "", "vorname": "Armin", "nachname": "Schuster", "partei": "CDU", "bundesland": "Baden-Württemberg", "email": "armin.schuster@bundestag.de", "telefon": "030-22775155", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" },
            { "anrede": "Herr", "titel": "", "vorname": "Thorsten", "nachname": "Frei", "partei": "CDU", "bundesland": "Baden-Württemberg", "email": "thorsten.frei@bundestag.de", "telefon": "030-22773133", "strasse": "Platz der Republik 1", "plz": "11011", "ort": "Berlin" }
        ];

        const bundeslaender = {
            "Baden-Württemberg": "BW", "Bayern": "BY", "Berlin": "BE", "Brandenburg": "BB", 
            "Bremen": "HB", "Hamburg": "HH", "Hessen": "HE", "Mecklenburg-Vorpommern": "MV",
            "Niedersachsen": "NI", "Nordrhein-Westfalen": "NW", "Rheinland-Pfalz": "RP", 
            "Saarland": "SL", "Sachsen": "SN", "Sachsen-Anhalt": "ST", "Schleswig-Holstein": "SH", "Thüringen": "TH"
        };
        const flagEmojis = {
            "Baden-Württemberg": " Baden-Württemberg", "Bayern": " Bayern", "Berlin": " Berlin", "Brandenburg": " Brandenburg", "Bremen": " Bremen", "Hamburg": " Hamburg", "Hessen": " Hessen", "Mecklenburg-Vorpommern": " Mecklenburg-Vorpommern", "Niedersachsen": " Niedersachsen", "Nordrhein-Westfalen": " Nordrhein-Westfalen", "Rheinland-Pfalz": " Rheinland-Pfalz", "Saarland": " Saarland", "Sachsen": " Sachsen", "Sachsen-Anhalt": " Sachsen-Anhalt", "Schleswig-Holstein": " Schleswig-Holstein", "Thüringen": " Thüringen"
        };

        const auswaertigesAmt = {
            name: "Auswärtiges Amt",
            email: "poststelle@auswaertiges-amt.de",
            telefon: "030-18170",
            strasse: "Werderscher Markt 1",
            plz: "10117",
            ort: "Berlin"
        };
        
        const emailSubject = "Dringende Bitte um Einsatz für Maja T.";
        const emailBody = `Sehr geehrte Damen und Herren,

ich wende mich mit einem dringenden Anliegen an Sie, welches mir persönlich sehr am Herzen liegt. Es geht um den Justizskandal rund um Maja T.
Maja T. ist eine nicht-binäre Person mit deutscher Staatsangehörigkeit, welcher von der ungarischen Staatsanwaltschaft Straftaten in Ungarn vorgeworfen werden. Maja T. wurde rechtswidrig an Ungarn ausgeliefert, wie das Bundesverfassungsgericht später feststellte. In Ungarn wird der Prozess von Maja T., auch auf Grund von Majas Geschlechtsidentität, politisch instrumentalisiert. Maja T. leidet unter menschenunwürdigen Haftbedingungen.

Maja T. fordert eine Rücküberstellung nach Deutschland und hier einen fairen und rechtsstaatlichen Prozess, bei welchem die Menschenrechte und das Prinzip Unschuldsvermutung eingehalten werden. Nach mehr als einem Jahr Untersuchungshaft ist Maja T. am 5. Juni 2025 in den Hungerstreik getreten.

Es ist meine tiefste Überzeugung, dass jede Person, egal welche Straftat ihr vorgeworfen wird, einen fairen und rechtsstaatlichen Prozess verdient.

Deshalb möchte ich Sie als Bundestagsabgeordnete dringlichst bitten, Ihren politischen Einfluss geltend zu machen und sich dafür einzusetzen, dass Maja T. so schnell wie möglich zurück nach Deutschland überstellt wird. Insbesondere möchte ich Sie bitten, auf den Bundeskanzler und den Außenminister einzuwirken, dass diese sich auf diplomatischem Wege persönlich für die Rücküberstellung von Maja T. einsetzen.

Ich hoffe, mein Anliegen stößt bei Ihnen auf ein offenes Ohr.

Mit freundlichen Grüßen



`;

        // Übersetzungen für die UI
        const translations = {
            de: {
                home_title: "Wir wollen reden – Druckkampagne für Maja",
                home_subtitle: "jetzt helfen.",
                home_main_button: "Kontaktiere die Verantwortlichen →",
                home_p1_strong: "Seit dem 5. Juni 2025 ist Maja im Hungerstreik.",
                home_p2: "Wir haben keine Zeit mehr. Wir müssen den Druck auf die Regierung und die Parteien JETZT erhöhen. Deswegen rufen wir dazu auf, das Gespräch mit den Verantwortlichen zu suchen und sie in die Verantwortung zu nehmen.",
                home_li1: "📢 Sucht gemeinsam die Büros der Regierungsparteien SPD und CDU in euren Städten auf und redet mit den Vertreter*innen der Parteien. Berichtet anschließend davon.",
                home_li2: "📞 Kontaktiert die Bundestagsabgeordneten aus eurer Stadt – per Telefon und per E-Mail.",
                home_li3: "📧 Kontaktiert das Auswärtige Amt – per Telefon und per E-Mail.",
                home_li4: "✊ Parallel dazu ist es wichtig, weiterhin durch Veranstaltungen, Kundgebungen, Demonstrationen und Aktionen des zivilen Ungehorsams Aufmerksamkeit für Majas Hungerstreik zu schaffen.",
                home_main_button_bottom: "Kontaktiere die Verantwortlichen →",
                back_button: "← Zurück zur Startseite",
                back_button_states: "← Anderes Bundesland wählen",
                state_title: "Wen willst du kontaktieren?",
                state_subtitle: "Wähle ein Bundesland, um Aktionen für 10 zufällige Abgeordnete vorzubereiten.",
                language_switcher_title: "Sprache ändern:",
                action_page_title_prefix: "Abgeordnete aus",
                main_email_button: "✉️ E-Mail an 10 Abgeordnete senden",
                foreign_office_email_button: "✉️ E-Mail an das Auswärtige Amt senden",
                download_pdf_button: "📄 Brief an 10 Abgeordnete als PDF herunterladen",
                contact_info_title: "Deine 10 zufälligen Kontakte:",
                foreign_office_title: "Kontakt Auswärtiges Amt",
                template_title: "Vorlagentext (E-Mail/Brief)",
                copy_button: "📋 Text in Zwischenablage kopieren",
                copy_success: "✅ Text kopiert!",
                name_prompt: "Wichtiger Hinweis: Bitte fügen Sie am Ende der E-Mail Ihren Namen (oder einen ausgedachten Namen) ein, bevor Sie sie absenden.",
                thank_you_message: "Danke für deinen Einsatz! ❤️"
            },
            tr: { // NOTE: Turkish translations are not fully updated for new features
                home_title: "Konuşmak istiyoruz – Maja için baskı kampanyası", home_subtitle: "1–3 Temmuz", home_main_button: "Sorumlularla iletişime geçin →", home_p1_strong: "Maja, 5 Haziran 2025'ten beri açlık grevinde.", home_p2: "Zamanımız kalmadı. Hükümet ve partiler üzerindeki baskıyı ŞİMDİ artırmalıyız. Bu nedenle 1-3 Temmuz tarihleri arasında sorumlularla görüşmeye ve onları sorumlu tutmaya çağırıyoruz.", home_li1: "📢 Şehirlerinizdeki hükümet partileri SPD ve CDU'nun ofislerini ziyaret edin ve parti temsilcileriyle konuşun. Ardından bunu rapor edin.", home_li2: "📞 Şehrinizdeki milletvekilleriyle telefon ve e-posta yoluyla iletişime geçin.", home_li3: "📧 Dışişleri Bakanlığı ile telefon ve e-posta yoluyla iletişime geçin.", home_li4: "✊ Aynı zamanda, Maja'nın açlık grevine dikkat çekmek için etkinlikler, mitingler, gösteriler ve sivil itaatsizlik eylemleri düzenlemeye devam etmek önemlidir.", home_main_button_bottom: "Sorumlularla iletişime geçin →", back_button: "← Ana sayfaya geri dön", back_button_states: "← Başka bir eyalet seç", state_title: "Kiminle iletişime geçmek istersiniz?", state_subtitle: "Rastgele 10 milletvekiline e-posta göndermek için bir eyalet seçin.", language_switcher_title: "Dili değiştir:", action_page_title_prefix: "Milletvekilleri:", main_email_button: "✉️ 10 milletvekiline e-posta gönder", contact_info_title: "Rastgele seçilen 10 kişiniz:", foreign_office_title: "Dışişleri Bakanlığı İletişim", thank_you_message: "Desteğiniz için teşekkürler! ❤️"
            },
            es: {}, it: {}, fr: {} // Other languages can be filled in similarly
        };

        let currentLanguage = 'de';
        let selectedMdbs = [];
        let selectedState = '';

        // ===== FUNKTIONEN =====

        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            window.scrollTo(0, 0);
        }

        function populateStateSelection() {
            const grid = document.getElementById('state-grid');
            grid.innerHTML = '';
            for (const state in bundeslaender) {
                const button = document.createElement('button');
                button.className = "bg-gray-800 hover:bg-gray-700 p-4 rounded-lg flex flex-col items-center justify-center text-center transition-colors";
                button.onclick = () => handleStateSelect(state);
                
                const flagText = flagEmojis[state] || state;
                button.innerHTML = `<span class="text-2xl mb-2">${flagText.split(' ')[0]}</span><span class="font-semibold text-white">${state}</span>`;
                grid.appendChild(button);
            }
        }

        function handleStateSelect(state) {
            selectedState = state;
            const stateMdbs = mdbData.filter(mdb => mdb.bundesland === state);
            
            const shuffled = stateMdbs.sort(() => 0.5 - Math.random());
            selectedMdbs = shuffled.slice(0, 10);
            
            if (selectedMdbs.length === 0) {
                alert(`Für ${state} wurden leider keine CDU/CSU-Abgeordneten in unserer Liste gefunden. Bitte wählen Sie ein anderes Bundesland.`);
                return;
            }

            generateActionPage(selectedMdbs);
            showPage('action-page');
        }

        function generateActionPage(mdbs) {
            const title = document.getElementById('action-page-title');
            title.textContent = `${translations[currentLanguage].action_page_title_prefix} ${selectedState}`;

            const content = document.getElementById('action-content');
            content.innerHTML = ''; // Clear previous content

            // 1. Action Buttons
            content.innerHTML += `
                <div class="space-y-4 max-w-lg mx-auto">
                    <button onclick="sendMail(selectedMdbs)" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-6 rounded-lg text-lg transition-transform transform hover:scale-105">
                        <span data-translate-key="main_email_button">${translations[currentLanguage].main_email_button}</span>
                    </button>
                    <button onclick="sendMail([auswaertigesAmt])" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg text-lg">
                        <span data-translate-key="foreign_office_email_button">${translations[currentLanguage].foreign_office_email_button}</span>
                    </button>
                    <button onclick="generatePdf(selectedMdbs)" class="w-full bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-3 px-6 rounded-lg text-lg">
                        <span data-translate-key="download_pdf_button">${translations[currentLanguage].download_pdf_button}</span>
                    </button>
                </div>
            `;

            // 2. Template View
            content.innerHTML += `
                <div class="mt-10 bg-gray-800 p-4 rounded-lg max-w-lg mx-auto">
                    <h3 class="text-xl font-bold text-white mb-3" data-translate-key="template_title">${translations[currentLanguage].template_title}</h3>
                    <pre class="bg-gray-900 p-3 rounded-md text-gray-300 whitespace-pre-wrap text-sm leading-relaxed">${emailBody}</pre>
                    <button id="copy-button" onclick="copyTemplateToClipboard(this)" class="mt-3 bg-gray-600 hover:bg-gray-500 text-white font-semibold py-2 px-4 rounded-lg w-full">
                        <span data-translate-key="copy_button">${translations[currentLanguage].copy_button}</span>
                    </button>
                </div>
            `;

            // 3. Kontaktkarten
            let cardsHtml = `<h3 class="text-2xl font-bold text-white mt-10 mb-4 border-b border-gray-600 pb-2" data-translate-key="contact_info_title">${translations[currentLanguage].contact_info_title}</h3><div class="grid grid-cols-1 md:grid-cols-2 gap-4">`;
            mdbs.forEach(mdb => {
                cardsHtml += createContactCard(mdb);
            });
            cardsHtml += '</div>';
            content.innerHTML += cardsHtml;
        }
        
        function createContactCard(person, isMdb = true) {
            const name = isMdb ? `${person.anrede} ${person.titel || ''} ${person.vorname} ${person.nachname}`.trim() : person.name;
            return `
                <div class="bg-gray-800 p-4 rounded-lg border border-gray-700">
                    <h4 class="font-bold text-lg text-white">${name}</h4>
                    ${isMdb ? `<p class="text-sm text-blue-300">${person.partei} - ${person.bundesland}</p>` : ''}
                    <div class="mt-3 space-y-2 text-sm">
                        <p>📧 <a href="mailto:${person.email}" class="text-blue-400 hover:underline break-all">${person.email}</a></p>
                        <p>📞 <a href="tel:${person.telefon}" class="text-blue-400 hover:underline">${person.telefon}</a></p>
                    </div>
                </div>
            `;
        }
        
        function sendMail(recipients) {
            alert(translations[currentLanguage].name_prompt);
            const bcc = recipients.map(r => r.email).join(',');
            const subject = encodeURIComponent(emailSubject);
            const body = encodeURIComponent(emailBody);
            window.location.href = `mailto:?bcc=${bcc}&subject=${subject}&body=${body}`;
        }
        
        function copyTemplateToClipboard(buttonElement) {
            navigator.clipboard.writeText(emailBody).then(() => {
                const originalText = buttonElement.querySelector('span').getAttribute('data-translate-key');
                const buttonSpan = buttonElement.querySelector('span');
                buttonSpan.setAttribute('data-translate-key', 'copy_success');
                buttonSpan.innerText = translations[currentLanguage].copy_success;
                
                setTimeout(() => {
                    buttonSpan.setAttribute('data-translate-key', originalText);
                    buttonSpan.innerText = translations[currentLanguage][originalText];
                }, 2000);
            });
        }

        function generatePdf(recipients) {
            const doc = new jsPDF();
            const today = new Date().toLocaleDateString('de-DE');

            recipients.forEach((mdb, index) => {
                if (index > 0) {
                    doc.addPage();
                }

                doc.setFont("helvetica", "normal");
                doc.setFontSize(11);

                doc.text("[Ihr Name]\n[Ihre Straße]\n[Ihre PLZ und Ort]", 20, 20);

                const nameLine = `${mdb.anrede} ${mdb.titel || ''} ${mdb.vorname} ${mdb.nachname}`.trim().replace(/\s+/g, ' ');
                const addressBlock = `${nameLine}\nDeutscher Bundestag\n${mdb.strasse}\n${mdb.plz} ${mdb.ort}`;
                doc.text(addressBlock, 20, 50);

                doc.text(today, 170, 80);

                doc.setFont("helvetica", "bold");
                doc.text(emailSubject, 20, 100);
                
                doc.setFont("helvetica", "normal");
                doc.text(emailBody, 20, 120, { maxWidth: 170 });
            });

            doc.save('Briefe_an_Abgeordnete.pdf');
        }

        function changeLanguage(lang) {
            if (!translations[lang] || Object.keys(translations[lang]).length === 0) return;
            currentLanguage = lang;
            const elements = document.querySelectorAll('[data-translate-key]');
            elements.forEach(el => {
                const key = el.getAttribute('data-translate-key');
                if (translations[lang][key]) {
                    el.innerHTML = translations[lang][key];
                }
            });
            if (document.getElementById('action-page').classList.contains('active')) {
                 const title = document.getElementById('action-page-title');
                 title.textContent = `${translations[currentLanguage].action_page_title_prefix} ${selectedState}`;
                 const copyButtonSpan = document.querySelector('#copy-button span');
                 if(copyButtonSpan) {
                     copyButtonSpan.innerText = translations[currentLanguage].copy_button;
                 }
            }
        }

        // ===== INITIALISIERUNG =====
        document.addEventListener('DOMContentLoaded', () => {
            populateStateSelection();
            changeLanguage('de'); // Standardsprache setzen
        });

    </script>
</body>
</html>
